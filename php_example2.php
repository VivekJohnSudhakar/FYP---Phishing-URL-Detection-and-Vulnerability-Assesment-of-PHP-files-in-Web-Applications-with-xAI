<?php

  /* DevBug - PHP Static Code Analysis written (mostly) in JavaScript */

  // Cross-Site Scripting (XSS)
  $name = $_GET['name']; // tainted by user input
  echo('Hello ' . $name); # tainted data reaches sensitive sink

  // cookie access
  $cookie_name = "user";
  $cookie_Value = "Srimatii";
  setcookie($cookie_name, $cookie_value,time()+(86400*30),"/");

  // Command Injection
  $cmd = $_COOKIE['cmd'];
  exec("cat /var/log/apache2/access.log | grep " . $cmd);

  // Deprecated Function
  $words = split(":","split:this");

  //String limiter present
  $result = substr("Hello How are you", 0, 5);

   $email = "john.doe@example.com";
  if (filter_var($email, FILTER_VALIDATE_EMAIL)) {
    echo("$email is a valid email address");
  } else {
    echo("$email is not a valid email address");
  }

  $search_html = filter_input(INPUT_GET, 'search', FILTER_SANITIZE_SPECIAL_CHARS);
  echo "You have searched for $search_html.\n";

  $a = 32;
  echo "a is " . is_numeric($a) . "<br>";

  $data = $_POST['data'];
  $data = preg_replace('/[^a-z0-9 ]/i', '', $data);

  $str = "Visit W3Schools";
  $pattern = "/w3schools/i";
  echo preg_match($pattern, $str);

?>
